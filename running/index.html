
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="ie=edge" http-equiv="x-ua-compatible"/>
<meta content="Data-Driven Intelligence for the communication and IoT industries" name="description"/>
<link href="https://canyanio.github.io/rating-integration/running/" rel="canonical"/>
<meta content="Canyan.io" name="author"/>
<meta content="Copy to clipboard" name="lang:clipboard.copy"/>
<meta content="Copied to clipboard" name="lang:clipboard.copied"/>
<meta content="en" name="lang:search.language"/>
<meta content="True" name="lang:search.pipeline.stopwords"/>
<meta content="True" name="lang:search.pipeline.trimmer"/>
<meta content="No matching documents" name="lang:search.result.none"/>
<meta content="1 matching document" name="lang:search.result.one"/>
<meta content="# matching documents" name="lang:search.result.other"/>
<meta content="[\s\-]+" name="lang:search.tokenizer"/>
<link href="../favicon.ico" rel="shortcut icon"/>
<meta content="mkdocs-1.0.4, mkdocs-material-4.6.0" name="generator"/>
<title>Running - Canyan Rating</title>
<link href="../assets/stylesheets/application.1b62728e.css" rel="stylesheet"/>
<link href="../assets/stylesheets/application-palette.a8b3c06d.css" rel="stylesheet"/>
<meta content="#7e57c2" name="theme-color"/>
<script src="../assets/javascripts/modernizr.268332fc.js"></script>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro,+Helvetica,+sans-serif:300,400,400i,700%7CUbuntu+Mono&amp;display=fallback" rel="stylesheet"/>
<style>body,input{font-family:"Source Sans Pro, Helvetica, sans-serif","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Ubuntu Mono","Courier New",Courier,monospace}</style>
<link href="../assets/fonts/material-icons.css" rel="stylesheet"/>
<script>
  window.ga = window.ga || function() {
    (ga.q = ga.q || []).push(arguments)
  }
  ga.l = +new Date
  /* Setup integration and send page view */
  ga("create", "UA-141188366-2", "auto")
  ga("set", "anonymizeIp", true)
  ga("send", "pageview")
  /* Register handler to log search on blur */
  document.addEventListener("DOMContentLoaded", () => {
    if (document.forms.search) {
      var query = document.forms.search.query
      query.addEventListener("blur", function() {
        if (this.value) {
          var path = document.location.pathname;
          ga("send", "pageview", path + "?q=" + this.value)
        }
      })
    }
  })
</script>
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
</head>
<body data-md-color-accent="deep-purple" data-md-color-primary="deep-purple" dir="ltr">
<svg class="md-svg">
<defs>
</defs>
</svg>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
<a class="md-skip" href="#running-canyan-rating" tabindex="1">
        Skip to content
      </a>
<header class="md-header" data-md-component="header">
<nav class="md-header-nav md-grid">
<div class="md-flex">
<div class="md-flex__cell md-flex__cell--shrink">
<a class="md-header-nav__button md-logo" href="https://canyanio.github.io/rating-integration/" title="Canyan Rating">
<img height="24" src="../logo.png" width="24"/>
</a>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
</div>
<div class="md-flex__cell md-flex__cell--stretch">
<div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
<span class="md-header-nav__topic">
              Canyan Rating
            </span>
<span class="md-header-nav__topic">
              
                Running
              
            </span>
</div>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
</div>
</div>
</nav>
</header>
<div class="md-container">
<main class="md-main" role="main">
<div class="md-main__inner md-grid" data-md-component="container">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title md-nav__title--site" for="__drawer">
<a class="md-nav__button md-logo" href="https://canyanio.github.io/rating-integration/" title="Canyan Rating">
<img height="48" src="../logo.png" width="48"/>
</a>
    Canyan Rating
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href=".." title="Home">
      Home
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../whats-new/" title="What's New ?">
      What's New ?
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../getting-started/" title="Getting started">
      Getting started
    </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-toggle md-nav__toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
        Running
      </label>
<a class="md-nav__link md-nav__link--active" href="./" title="Running">
      Running
    </a>
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#with-docker-compose">
    With Docker Compose
  </a>
<nav class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#prerequisites">
    Prerequisites
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#run">
    Run
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#as-local-services">
    As local services
  </a>
<nav class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#prerequisites_1">
    Prerequisites
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#install-canyan-rating">
    Install Canyan Rating
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#run_1">
    Run
  </a>
<nav class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#api">
    API
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#engine">
    Engine
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#agent">
    Agent
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" id="nav-5" type="checkbox"/>
<label class="md-nav__link" for="nav-5">
      Agent
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="1">
<label class="md-nav__title" for="nav-5">
        Agent
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../agent/agent/" title="Introduction">
      Introduction
    </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-5-2" id="nav-5-2" type="checkbox"/>
<label class="md-nav__link" for="nav-5-2">
      Endpoints
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-5-2">
        Endpoints
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../agent/endpoints/authorization/" title="Authorization">
      Authorization
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../agent/endpoints/transaction-begin/" title="Begin Transaction">
      Begin Transaction
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../agent/endpoints/transaction-end/" title="End Transaction">
      End Transaction
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../agent/endpoints/transaction-record/" title="Record Transaction">
      Record Transaction
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../agent/endpoints/transaction-rollback/" title="Rollback Transaction">
      Rollback Transaction
    </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../hep-agent/" title="HEP Agent">
      HEP Agent
    </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" id="nav-7" type="checkbox"/>
<label class="md-nav__link" for="nav-7">
      API
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="1">
<label class="md-nav__title" for="nav-7">
        API
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../api/api/" title="Introduction">
      Introduction
    </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-7-2" id="nav-7-2" type="checkbox"/>
<label class="md-nav__link" for="nav-7-2">
      Endpoints
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="2">
<label class="md-nav__title" for="nav-7-2">
        Endpoints
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../api/endpoints/carrier/" title="Carrier">
      Carrier
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api/endpoints/pricelist/" title="Pricelist">
      Pricelist
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api/endpoints/rate/" title="Rate">
      Rate
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api/endpoints/account/" title="Account">
      Account
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../api/endpoints/transaction/" title="Transaction">
      Transaction
    </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../engine/" title="Engine">
      Engine
    </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" id="nav-9" type="checkbox"/>
<label class="md-nav__link" for="nav-9">
      Tutorials
    </label>
<nav class="md-nav" data-md-component="collapsible" data-md-level="1">
<label class="md-nav__title" for="nav-9">
        Tutorials
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../tutorials/inserting-data/" title="Inserting Data">
      Inserting Data
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../tutorials/authorizations/" title="Authorizations">
      Authorizations
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../tutorials/transactions/" title="Transactions">
      Transactions
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../tutorials/kamailio-integration/" title="Kamailio Integration">
      Kamailio Integration
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../tutorials/kamailio-hep-integration/" title="Kamailio HEP Integration">
      Kamailio HEP Integration
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../tutorials/opensips-integration/" title="OpenSIPS Integration">
      OpenSIPS Integration
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../tutorials/opensips-hep-integration/" title="OpenSIPS HEP Integration">
      OpenSIPS HEP Integration
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../faq/" title="FAQ">
      FAQ
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../license/" title="License">
      License
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../contributing/" title="Contributing">
      Contributing
    </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../code-of-conduct/" title="Code of conduct">
      Code of conduct
    </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">Table of contents</label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#with-docker-compose">
    With Docker Compose
  </a>
<nav class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#prerequisites">
    Prerequisites
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#run">
    Run
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#as-local-services">
    As local services
  </a>
<nav class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#prerequisites_1">
    Prerequisites
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#install-canyan-rating">
    Install Canyan Rating
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#run_1">
    Run
  </a>
<nav class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#api">
    API
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#engine">
    Engine
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#agent">
    Agent
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<h1 id="running-canyan-rating">Running Canyan Rating</h1>
<p>In the <a href="../getting-started/">Getting Started</a> section we introduced the different components of Canyan Rating. The ecosystem can be run locally, on virtual machines or in the cloud. We will present you here the two most common ways to do it:
* with Docker Compose
* as local services</p>
<h2 id="with-docker-compose">With Docker Compose</h2>
<p>The easiest way of running Canyan Rating is with <a href="https://docs.docker.com/compose/">Docker Compose</a>. </p>
<h3 id="prerequisites">Prerequisites</h3>
<p>The prerequisites to run Canyan Rating with Docker Compose are the following:</p>
<ul>
<li><a href="https://docs.docker.com/install/">Docker Engine</a></li>
<li><a href="https://docs.docker.com/compose/">Docker Compose</a></li>
</ul>
<p>If you don't have a machine running Docker and Docker Compose don't worry; it's a very easy software to install. Just follow the guides on the official <a href="https://www.docker.com">Docker website</a>. Docker can be easily run on your laptop regardless of the operating system you're using.</p>
<h3 id="run">Run</h3>
<p>The <a href="https://github.com/canyanio/rating-integration">integration repository</a> provides you the <a href="https://github.com/canyanio/rating-integration/blob/master/docker-compose.yaml">docker-compose.yaml</a> needed run Canyan Rating in docker compose.</p>
<p>Start with cloning the repository locally:</p>
<div class="codehilite"><pre><span></span><span class="err">git clone git@github.com:canyanio/rating-integration.git</span>
</pre></div>
<p>The <a href="https://github.com/canyanio/rating-integration/blob/master/Makefile">Makefile</a> provides you two shortcut commands:
<code>make docker-start</code> and <code>make docker-stop</code>.</p>
<p>As you can imagine <code>make docker-start</code> will start Canyan Rating Engine in a docker compose environment exposing the needed two ports to interface with the Rating API and Agent (8000 and 8080 respectively).</p>
<h2 id="as-local-services">As local services</h2>
<p>This is the another way of installing the different components of Canyan Rating using the Python Package Index and running them on your machine.</p>
<h3 id="prerequisites_1">Prerequisites</h3>
<p>The following components are needed:</p>
<ul>
<li><a href="https://www.mongodb.com/">MongoDB</a></li>
<li><a href="https://www.rabbitmq.com/">RabbitMQ</a></li>
<li><a href="https://www.python.org/">Python</a></li>
</ul>
<p>MongoDB and RabbitMQ will be used by the components specifying the URIs and credentials with flags upon running them. We will cover that later.</p>
<h3 id="install-canyan-rating">Install Canyan Rating</h3>
<p>It's recommended to use a <a href="https://docs.python.org/3/library/venv.html">Python virtual environment</a> to isolate the installed packages from system site directories:</p>
<div class="codehilite"><pre><span></span><span class="err">virtualenv -p python3 venv --no-site-packages</span>
<span class="err">source venv/bin/activate</span>
</pre></div>
<p>We will now use <a href="https://pypi.org/project/pip/">pip</a> to install Canyan's packages from the <a href="https://pypi.org/">Python Package Index</a>:</p>
<div class="codehilite"><pre><span></span><span class="err">pip install canyan-rating-api canyan-rating-agent canyan-rating-engine</span>
</pre></div>
<h3 id="run_1">Run</h3>
<p>For all the installed components you can run the command with the flag <code>--help</code> to have a full list of options and defaults that the command accepts.</p>
<h4 id="api">API</h4>
<p>Let's now run the API with the following command:</p>
<div class="codehilite"><pre><span></span><span class="err">canyan-rating-api \</span>
<span class="err">  -h 0.0.0.0 \</span>
<span class="err">  -p 8000 \</span>
<span class="err">  --mongodb-uri mongodb://localhost:27017</span>
</pre></div>
<p>Please change the values of the options accordingly to your local setup.</p>
<h4 id="engine">Engine</h4>
<p>The canyan-rating-engine is run with the following command:</p>
<div class="codehilite"><pre><span></span><span class="err">canyan-rating-engine \</span>
<span class="err">  --messagebus-uri pyamqp://user:password@localhost:5672// \</span>
<span class="err">  --api-url http://localhost:8000</span>
</pre></div>
<h4 id="agent">Agent</h4>
<p>Now the agent can be run with the command:</p>
<div class="codehilite"><pre><span></span><span class="err">canyan-rating-engine \</span>
<span class="err">  -h 0.0.0.0 \</span>
<span class="err">  -p 8080 \</span>
<span class="err">  --messagebus-uri pyamqp://user:password@localhost:5672// \</span>
<span class="err">  --api-url http://localhost:8000</span>
</pre></div>
<p>Et voilà! You have now Canyan Rating up and running! </p>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav class="md-footer-nav__inner md-grid">
<a class="md-flex md-footer-nav__link md-footer-nav__link--prev" href="../getting-started/" rel="prev" title="Getting started">
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
</div>
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
                  Previous
                </span>
                Getting started
              </span>
</div>
</a>
<a class="md-flex md-footer-nav__link md-footer-nav__link--next" href="../agent/agent/" rel="next" title="Introduction">
<div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
<span class="md-flex__ellipsis">
<span class="md-footer-nav__direction">
                  Next
                </span>
                Introduction
              </span>
</div>
<div class="md-flex__cell md-flex__cell--shrink">
<i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
<div class="md-footer-copyright__highlight">
            Copyright © 2020 Canyan.io
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
</div>
<div class="md-footer-social">
<link href="../assets/fonts/font-awesome.css" rel="stylesheet"/>
<a class="md-footer-social__link fa fa-github" href="https://github.com/canyanio"></a>
<a class="md-footer-social__link fa fa-twitter" href="https://twitter.com/canyan_io"></a>
<a class="md-footer-social__link fa fa-linkedin" href="https://www.linkedin.com/company/canyan/"></a>
<a class="md-footer-social__link fa fa-slack" href="http://slack.canyan.io"></a>
</div>
</div>
</div>
</footer>
</div>
<script src="../assets/javascripts/application.808e90bb.js"></script>
<script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
<script src="https://unpkg.com/mermaid@7.1.2/dist/mermaid.min.js"></script>
</body>
</html>